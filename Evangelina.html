<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>The eR-Biostat initiative : Using R markdown to develop E-learning capacity</title>

<script src="Evangelina_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Evangelina_files/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="Evangelina_files/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="Evangelina_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="Evangelina_files/navigation-1.1/tabsets.js"></script>
<script src="Evangelina_files/navigation-1.1/codefolding.js"></script>
<link href="Evangelina_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="Evangelina_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="Evangelina_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="Evangelina_files/readthedown-0.1/readthedown.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


</head>

<body>


<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>


<div id="header">
<h1 class="title">The eR-Biostat initiative : Using R markdown to develop E-learning capacity</h1>
<h1 class="subtitle">Logistic regression modeling using R at the SUSAN-SSACAB 2019 Conference, Cape Town, South Africa</h1>
</div>


<div id="table-of-contents">
    <h2><a href="#content">The eR-Biostat initiative : Using R markdown to develop E-learning capacity</a></h2>
    <div id="text-table-of-contents">
      <ul>
      <li><a href="#the-glm-course">The GLM Course</a><ul>
      <li><a href="#an-example-from-the-glm-course">An example from the GLM course</a></li>
      </ul></li>
      <li><a href="#model-formulation">Model formulation</a></li>
      <li><a href="#session-information">Session information</a></li>
      <li><a href="#references">References</a></li>
      </ul>
    </div>
</div>

<div id="main">
<div id="the-glm-course" class="section level1 unnumbered">
<h1>The GLM Course</h1>
<div id="an-example-from-the-glm-course" class="section level2 unnumbered">
<h2>An example from the GLM course</h2>
<p>The Aspirin Use and Myocardial Infarction dataset includes the results of a study on the relationship between aspirin use and heart attacks by the Physicians’ Health Study
Research Group at Harvard Medical School <span class="citation">(Agresti 2012)</span>. The Physicians’ Health Study was a 5-year randomized study of whether regular aspirin intake reduces
mortality from cardiovascular disease. Every other day, physicians participating
in the study took either one aspirin tablet or a placebo. The study was
blinded-those in the study did not know whether they were taking aspirin or a
placebo. Of the 11034 physicians taking placebo, 189 suffered heart attacks, a proportion of <span class="math inline">\(189/11034=0.0171\)</span>. Of the 11037 taking aspirin, 104 had heart attacks, a proportion of
<span class="math inline">\(0.0094\)</span>. The R code below is used to construct the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">resp&lt;-<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">189</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">10845</span>),<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">104</span>),<span class="kw">rep</span>(<span class="dv">1</span> ,<span class="dv">10933</span>)))</a>
<a class="sourceLine" id="cb1-2" title="2">trt&lt;-<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">189</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">10845</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">104</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">10933</span>)))</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">cbind</span>(resp,trt)</a>
<a class="sourceLine" id="cb1-4" title="4">Aspirin<span class="fl">.1</span>&lt;-<span class="kw">table</span>(trt,resp)</a>
<a class="sourceLine" id="cb1-5" title="5">Aspirin<span class="fl">.1</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">row.names</span>(Aspirin<span class="fl">.1</span>)=<span class="kw">c</span>(<span class="st">&quot;Placebo&quot;</span>,<span class="st">&quot;Aspirin&quot;</span>)</a></code></pre></div>
<p>A barplot of the data can be produced using the <code>barplot()</code> function</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">barplot</span>(<span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">189</span>,<span class="dv">10845</span>)<span class="op">/</span>(<span class="dv">189</span><span class="op">+</span><span class="dv">10845</span>),<span class="kw">c</span>(<span class="dv">104</span>,<span class="dv">10933</span>)<span class="op">/</span>(<span class="dv">104</span><span class="op">+</span><span class="dv">10933</span>))</a>
<a class="sourceLine" id="cb2-2" title="2">,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">,<span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;No&quot;</span>))</a></code></pre></div>
<p><img src="Evangelina_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
</div>
</div>
<div id="model-formulation" class="section level1 unnumbered">
<h1>Model formulation</h1>
<p>Let <span class="math inline">\(Y_{i}\)</span> be the response variable,
<span class="math display">\[
Y_{i}=\left \{
\begin{array}{ll}
1, &amp; \mbox{Myocardial Infarction}, \\
0, &amp; \mbox{Healty}. 
\end{array}
\right .
\]</span></p>
<p>Our main interest it to model the probability
<span class="math display">\[
P(Y_{i}=1)=\pi_{i},
\]</span></p>
<p>with linear predictor given by <span class="math inline">\(\beta_{0}+\beta_{1}\)</span>Treatment<span class="math inline">\(_{i}\)</span>.</p>
<p>The parameter <span class="math inline">\(\beta_{1}\)</span> is the log(odds ratio), that is <span class="math inline">\(OR=\exp(\beta_{1})\)</span>.</p>
<p>The model can be estimated in R using the <code>glm()</code> function for the analysis we use the zero/one version of the data which creates two vectors of the data, that is</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">resp&lt;-<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">189</span>),<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10845</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">104</span>),<span class="kw">rep</span>(<span class="dv">0</span> ,<span class="dv">10933</span>)))</a>
<a class="sourceLine" id="cb3-2" title="2">trt&lt;-<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">189</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">10845</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">104</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">10933</span>)))</a></code></pre></div>
<pre><code>##    resp
## trt     0     1
##   1 10845   189
##   2 10933   104</code></pre>
<p>Using the two vectors, <code>resp</code> and <code>trt</code> the model is fitted using the following code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">fit.myoc&lt;-<span class="kw">glm</span>(resp<span class="op">~</span><span class="kw">relevel</span>(trt,<span class="dv">2</span>),<span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>))</a></code></pre></div>
<p>We model the probability of success <code>P(Z=1)</code>. This is the probability to have cardiovascular disease. We want to see if Aspirin intake has an effect on the probability to have Myocardial infarction.</p>
<p>The output is given below.</p>
<pre><code>## 
## Call:
## glm(formula = resp ~ relevel(trt, 2), family = binomial(link = &quot;logit&quot;))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.0544   0.1376   0.1376   0.1859   0.1859  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       4.65515    0.09852  47.250  &lt; 2e-16 ***
## relevel(trt, 2)1 -0.60544    0.12284  -4.929 8.28e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3114.7  on 22070  degrees of freedom
## Residual deviance: 3089.3  on 22069  degrees of freedom
## AIC: 3093.3
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<p>The parameter estimate for <span class="math inline">\(\beta_{1}\)</span> is equal to <code>0.605</code></p>
<pre><code>##      (Intercept) relevel(trt, 2)1 
##        4.6551501       -0.6054377</code></pre>
<p>and the odds ratio is equal to 1.83, indication that taking one Aspirin tablet per day reduce the risk for Myocardial Infarction.</p>
<pre><code>## relevel(trt, 2)1 
##        0.5458355</code></pre>
</div>
<div id="session-information" class="section level1 unnumbered">
<h1>Session information</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United Kingdom.1252   
## [3] LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] bookdown_0.13    rmarkdown_1.15   knitr_1.24       BiocStyle_2.12.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.2         digest_0.6.20      later_0.8.0        mime_0.7           R6_2.4.0          
##  [6] xtable_1.8-4       magrittr_1.5       evaluate_0.14      rmdformats_0.3.6   highr_0.8         
## [11] stringi_1.4.3      rstudioapi_0.10    promises_1.0.1     miniUI_0.1.1.1     tools_3.6.1       
## [16] stringr_1.4.0      questionr_0.7.0    shiny_1.3.2        httpuv_1.5.1       xfun_0.9          
## [21] yaml_2.2.0         compiler_3.6.1     BiocManager_1.30.4 htmltools_0.3.6</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-ag">
<p>Agresti, Alan. 2012. <em>Categorical Data Analysis.</em> WILEY.</p>
</div>
</div>
</div>
</div>


</div>

<div id="postamble" data-toggle="wy-nav-shift" class="status">
<p class="author"><span class="glyphicon glyphicon-user"></span> Olajumoke Evangelina Owokotomo
<br /><span class="author_affil">Hasselt University, Belgium</span></p>
<p class="date"><span class="glyphicon glyphicon-calendar"></span> September 8 - 11, 2019</p>
</div>


<script>
$(document).ready(function () {
 	  });
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
